<div
  class="card-header p-2 rounded bg-gray d-flex justify-content-between align-items-center rounded-top rounded-0"
>
  <div>
    <h6 class="text-primary fw-bold mb-0">Agrément</h6>
    <small class="text-muted x-small" [innerHTML]="event_at"> </small>
  </div>
  <div>
    <ng-container *ngIf="centerButton">
      <ng-container *ngIf="centerButton.type == 'link'">
        <a
          type="button"
          [href]="centerButton.href"
          class="btn btn-outline-primary"
          >{{ centerButton.text }}
        </a>
      </ng-container>
    </ng-container>
  </div>
  <div class="d-flex justify-content-between align-items-center" role="button">
    <ng-container *ngIf="lastAction">
      <span [class]="'badge p-2 bg-' + lastAction.theme">
        {{ lastAction.label }}
      </span>
    </ng-container>
    <span class="p-1" (click)="toggle()">
      <app-icon
        icon="chevron-right"
        *ngIf="!active"
        classe="fw-bolder ms-3"
      ></app-icon>
      <app-icon
        icon="chevron-down"
        *ngIf="active"
        classe="fw-bolder ms-3"
      ></app-icon>
    </span>
  </div>
</div>
<div
  class="m-3 small text-small"
  [class.d-block]="active"
  [class.d-none]="!active"
>
  <div class="card-body" *ngFor="let item of historiques">
    <div class="form-check">
      <ng-container *ngIf="item.meta">
        <ng-container *ngIf="item.title">
          <input class="form-check-input" type="radio" checked />
          <label
            class="form-check-label text-primary fw-semibold"
            [innerHTML]="item.title"
          >
          </label>
          <br />
        </ng-container>
      </ng-container>
    </div>
    <!-- paiement frais a anatt -->

    <!-- convocation-code-telechargement -->
    <div class="bg-light p-3 rounded col-sm-11 ms-auto mb-3">
      <div [innerHTML]="item.message"></div>
      <div class="mt-2">
        <ng-container *ngIf="item.meta">
          <div
            class="mb-2"
            *ngIf="
              item.action == 'demande-agrement-rejected' ||
              item.action == 'demande-agrement-pending'
            "
          >
            <ng-container *ngIf="item.action == 'demande-agrement-rejected'">
              <a
                *ngIf="!!item.meta.demandeRejet"
                type="button"
                [routerLink]="['/demande-agrement', item.meta.demandeRejet.id]"
                class="btn btn-primary"
                >Corriger la demande
              </a>
              <a
                *ngIf="!item.meta.demandeRejet"
                type="button"
                class="btn btn-primary disabled"
                >Corriger la demande
              </a>
            </ng-container>
          </div>
          <ng-container *ngIf="item.action == 'demande-agrement-validate'">
            <div class="mb-2" *ngIf="item.meta">
              <a
                type="button"
                (click)="download(item.meta.id)"
                class="btn btn-primary"
                >Télécharger l'agrément
              </a>
            </div>
          </ng-container>

          <ng-container *ngIf="item.action == 'paiement-approved'">
            <div class="mb-2" *ngIf="item.meta">
              <a
                type="button"
                (click)="download(item.meta.id, 'facture')"
                class="btn btn-primary"
                >Télécharger la facture
              </a>
            </div>
          </ng-container>
        </ng-container>
        <small class="text-muted small" [innerHTML]="item.event_at"> </small>
      </div>
    </div>
  </div>
</div>
