<div class="bg-modal p-3 py-4 rounded shadow-sm" *ngIf="data && candidat">
  <div class="border p-1 rounded-3">
    <div class="d-flex">
      <div class="avatar">
        <img [src]="candidat.avatar" class="img-fluid rounded-3" alt="" />
      </div>

      <div class="d-flex flex-column justify-content-between ms-2">
        <h5
          class="pt-2"
          style="color: #313131; font-size: 22px; font-weight: 600"
        >
          {{ candidat.nom }} {{ candidat.prenoms }}
        </h5>
        <h6 class="pb-2" style="color: #575656; font-size: 16px">
          NPI : {{ candidat.npi }}
        </h6>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-7">
      <h5 class="my-3">Information sur le permis</h5>
      <div class="card bg-transparent border">
        <div class="card-body">
          <div class="mb-3">
            <div class="fw-semibold h6">Catégorie de permis</div>
            Permis {{ data?.categorie_permis?.name }}
          </div>
          <div class="mb-3">
            <div class="fw-semibold h6">Langue de composition</div>
            {{ data?.langue?.name }}
          </div>
          <div class="mb-3">
            <div class="fw-semibold h6">Auto école</div>
            {{ data?.auto_ecole?.name }}
          </div>
          <div class="mb-3">
            <div class="fw-semibold h6">Centre d'examen</div>
            {{ data?.annexe?.name }}
          </div>
          <div class="mb-3">
            <div class="fw-semibold h6">Parcours</div>
            <ng-container *ngIf="data.type_examen == 'conduite'">
              Conduite
            </ng-container>
            <ng-container *ngIf="data.type_examen != 'conduite'">
              Code & Conduite
            </ng-container>
          </div>
          <ng-container *ngIf="data.date_inscription">
            <div class="mb-3">
              <div class="fw-semibold h6">Date de pré-inscription</div>
              {{ data.date_inscription | hdate }}
            </div>
          </ng-container>

          <ng-container *ngIf="data.date_suivi">
            <div class="mb-3">
              <div class="fw-semibold h6">Date de certification</div>
              {{ data.date_suivi | hdate }}
            </div>
          </ng-container>
          <ng-container *ngIf="data.examen">
            <div class="mb-3">
              <div class="fw-semibold h6">Examen choisi</div>
              {{ data.examen.session_long }}
            </div>
          </ng-container>

          <ng-container *ngIf="data.extension">
            <div class="mb-3">
              <div class="fw-semibold h6">Permis (extension)</div>
              Permis {{ data.extension?.name }}
            </div>
          </ng-container>

          <ng-container *ngIf="data.prealable">
            <div class="mb-3">
              <div class="fw-semibold h6">Permis (préalable)</div>
              Permis {{ data.prealable?.name }}
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    <div class="col-sm-5">
      <h5 class="my-3">Information sur le permis</h5>
      <div class="card bg-transparent border">
        <div class="card-body">
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <div class="fw-semibold h6">Groupe sanguin</div>
                {{ dossier?.group_sanguin }}
              </div>
            </div>
            <div class="col">
              <div class="mb-3">
                <div class="fw-semibold h6">Restriction médicales</div>
                <!-- {{ data?.restriction?.name }} -->
                {{ getSelectedRestrictionNames() }}
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <div class="fw-semibold h6">Test de groupage</div>
                <div
                  class="prev-eye col-md-9 col-xl-7"
                  (click)="openSuiviModal(dossier?.groupage_test)"
                >
                  <div class="overlay"></div>
                  <app-icon icon="eye"></app-icon>
                  <img
                    [src]="assets(dossier?.groupage_test)"
                    alt="Aperçu de l'image"
                    class="img-fluid"
                  />
                </div>
              </div>
            </div>
            <div class="col">
              <div class="mb-3">
                <div class="fw-semibold h6">Fiche médicale</div>
                <div
                  class="prev-eye col-md-9 col-xl-7"
                  (click)="openSuiviModal(data?.fiche_medical)"
                >
                  <div class="overlay"></div>
                  <app-icon icon="eye"></app-icon>
                  <img
                    [src]="assets(data?.fiche_medical)"
                    alt="Aperçu de l'image"
                    class="img-fluid"
                  />
                </div>
              </div>
            </div>

            <div class="mb-3" *ngIf="dossier?.ancien_permis?.fichier_permis_prealable">
              <div class="fw-semibold h6">Information Permis Préalable</div>
              <div
                class="prev-eye col-md-9 col-xl-7"
                (click)="openSuiviModal(dossier?.ancien_permis?.fichier_permis_prealable)"
              >
                <div class="overlay"></div>
                <app-icon icon="eye"></app-icon>
                <img
                  [src]="assets(dossier?.ancien_permis?.fichier_permis_prealable || '')"
                  alt="Aperçu de l'image"
                  class="img-fluid"
                />
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
  <h5 class="mt-3 mb-2">Parcours de formation</h5>
  <div class="card border bg-transparent">
    <div class="card-body">
      <div class="list-group">
        <label
          class="list-group-item bg-transparent text-uppercase mb-1 border-0"
          *ngFor="let chap of chapitres"
        >
          <input
            class="form-check-input me-1"
            disabled
            type="checkbox"
            checked
          />
          <strong class="ms-2">Chapitre</strong>: {{ chap.name }}
        </label>
      </div>

      <div class="form-check">
        <input
          class="form-check-input"
          type="checkbox"
          value=""
          id="accepted"
          disabled
          checked
        />
        <label class="form-check-label" for="accepted">
          <strong
            >Je soussigné {{ data?.auto_ecole?.promoteur_name }} moniteur à
            l’auto-école {{ data?.auto_ecole?.name }} certifie que tous ces
            chapitres ont été abordé avec les candidats.</strong
          >
        </label>
      </div>
      <div class="mt-3" *ngIf="page == 'pending'">
        <button class="btn btn-primary" (click)="onValidate()">
          Valider le dossier
        </button>
        <button class="btn btn-danger ms-2" (click)="onRejected()">
          Rejeter le dossier
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  [id]="'suivi-' + data.id"
  tabindex="-1"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  role="dialog"
  aria-hidden="true"
>
  <div
    class="modal-dialog modal-dialog-scrollable modal-dialog-centered"
    role="document"
  >
    <div class="modal-content rounded-3">
      <div class="modal-header">
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="previewUrl = ''"
        ></button>
      </div>
      <div class="modal-body text-center">
        <img [src]="assets(previewUrl)" class="w-block img-fluid mx-auto" />
      </div>
    </div>
  </div>
</div>
